<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="robots" content="noindex,nofollow" />
  <title>Diagn√≥stico de Ocorr√™ncias ‚Äî DIEF/SEFAZ-RR</title>
  <style>
    :root{
  /* Base institucional azul (mais claro) */
  --bg:#f3f7ff;          /* fundo bem claro azulado */
  --card:#ffffff;        /* cards brancos */
  --card2:#f7faff;       /* varia√ß√£o suave */
  --text:#0b1b3a;        /* texto azul-marinho */
  --muted:#3c567a;       /* texto secund√°rio */

  --line:rgba(11,27,58,.14);
  --chip:rgba(10,98,190,.08);

  --ok:#16a34a;
  --warn:#f59e0b;
  --bad:#dc2626;
  --info:#0a62be;

  --shadow: 0 10px 28px rgba(11,27,58,.12);
  --radius: 18px;

  --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Helvetica Neue", "Noto Sans", "Liberation Sans", sans-serif;
}

    *{ box-sizing:border-box; }
    body{
      margin:0; font-family:var(--sans); background: radial-gradient(1200px 800px at 20% -20%, rgba(102,179,255,.18), transparent 60%),
      radial-gradient(900px 700px at 90% 0%, rgba(255,92,122,.14), transparent 60%),
      radial-gradient(900px 700px at 30% 110%, rgba(69,224,138,.10), transparent 60%),
      var(--bg);
      color:var(--text);
    }
    a{ color:inherit; }
    .wrap{ max-width:1100px; margin:0 auto; padding:28px 18px 70px; }
    header{ display:flex; gap:14px; align-items:flex-start; justify-content:space-between; flex-wrap:wrap; }
    .title h1{ margin:0 0 6px; font-size:22px; letter-spacing:.2px; }
    .title p{ margin:0; color:var(--muted); font-size:13px; max-width:820px; line-height:1.4; }
    .pill{
      display:inline-flex; align-items:center; gap:8px; padding:10px 12px; border:1px solid var(--line);
      border-radius:999px; background:rgba(255,255,255,.04); color:var(--muted); font-size:12px;
      box-shadow: 0 10px 30px rgba(0,0,0,.18);
    }
    .pill b{ color:var(--text); font-weight:600; }
    .grid{ display:grid; gap:14px; }
    .kpis{ grid-template-columns: repeat(5, minmax(0,1fr)); margin-top:18px; }
    @media (max-width: 980px){ .kpis{ grid-template-columns: repeat(2, minmax(0,1fr)); } }
    @media (max-width: 520px){ .kpis{ grid-template-columns: 1fr; } }
    .kpi{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--line); border-radius:var(--radius); padding:14px 14px 12px;
      box-shadow: var(--shadow);
    }
    .kpi .label{ color:var(--muted); font-size:12px; }
    .kpi .value{ font-size:22px; font-weight:700; margin-top:6px; letter-spacing:.2px; }
    .kpi .hint{ color:var(--muted); font-size:12px; margin-top:6px; }
    .bar{
      margin-top:16px; border:1px solid var(--line); border-radius:var(--radius); background:rgba(255,255,255,.03);
      padding:14px; box-shadow: var(--shadow);
    }
    .barTop{ display:flex; gap:12px; align-items:center; justify-content:space-between; flex-wrap:wrap; }
    .search{
      flex:1; min-width:260px; display:flex; gap:10px; align-items:center;
      border:1px solid var(--line); background:rgba(0,0,0,.18); border-radius:999px; padding:10px 12px;
    }
    .search input{
      flex:1; border:0; outline:none; background:transparent; color:var(--text); font-size:14px;
    }
    .search input::placeholder{ color:rgba(168,177,214,.75); }
    .chips{ display:flex; gap:8px; flex-wrap:wrap; }
    .chip{
  cursor:pointer; user-select:none;
  border:1px solid var(--line);
  background: rgba(255,255,255,.85);
  padding:8px 10px;
  border-radius:999px;
  font-size:12px;
  color: rgba(60,86,122,.95);
  transition: transform .06s ease, background .12s ease;
}

    .chip:hover{ transform: translateY(-1px); }
    .chip.active{ background:rgba(102,179,255,.18); color:var(--text); border-color:rgba(102,179,255,.35); }
    .subnote{ margin-top:10px; color:var(--muted); font-size:12px; line-height:1.4; }
    .list{ margin-top:18px; }
    .sectionTitle{
      display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap;
      margin:18px 2px 10px;
    }
    .sectionTitle h2{ margin:0; font-size:15px; color:var(--text); letter-spacing:.2px; }
    .sectionTitle .count{ color:var(--muted); font-size:12px; }
    .cards{
      display:grid; grid-template-columns: repeat(3, minmax(0, 1fr)); gap:14px;
    }
    @media (max-width: 980px){ .cards{ grid-template-columns: repeat(2, minmax(0, 1fr)); } }
    @media (max-width: 640px){ .cards{ grid-template-columns: 1fr; } }
    .card{
      border:1px solid var(--line); border-radius:var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      box-shadow: var(--shadow);
      padding:14px;
      cursor:pointer;
      transition: transform .08s ease, border-color .12s ease;
      min-height: 150px;
    }
    .card:hover{ transform: translateY(-2px); border-color: rgba(255,255,255,.18); }
    .card .top{ display:flex; align-items:flex-start; justify-content:space-between; gap:10px; }
    .card h3{ margin:0; font-size:14px; line-height:1.25; }
    .meta{ display:flex; gap:8px; flex-wrap:wrap; margin-top:10px; }
    .badge{
      display:inline-flex; align-items:center; gap:6px;
      padding:6px 9px; border-radius:999px; font-size:11px;
      border:1px solid var(--line); background:rgba(0,0,0,.18); color:var(--muted);
    }
    .badge b{ font-weight:600; color:var(--text); }
    .badge.ok{ border-color: rgba(69,224,138,.35); background: rgba(69,224,138,.12); }
    .badge.warn{ border-color: rgba(255,209,102,.35); background: rgba(255,209,102,.12); }
    .badge.bad{ border-color: rgba(255,92,122,.35); background: rgba(255,92,122,.12); }
    .badge.info{ border-color: rgba(102,179,255,.35); background: rgba(102,179,255,.12); }
    .snippet{ margin-top:10px; color:var(--muted); font-size:12px; line-height:1.45; }
    .footerRow{ margin-top:12px; display:flex; align-items:center; justify-content:space-between; gap:10px; color:var(--muted); font-size:12px; }
    .btn{
      border:1px solid var(--line); background:rgba(255,255,255,.05); color:var(--text);
      padding:10px 12px; border-radius:12px; font-size:12px; cursor:pointer;
      transition: transform .06s ease;
    }
    .btn:hover{ transform: translateY(-1px); }
    .btn.primary{ border-color: rgba(102,179,255,.35); background: rgba(102,179,255,.14); }
    .btn.danger{ border-color: rgba(255,92,122,.35); background: rgba(255,92,122,.12); }
    .btn.mono{ font-family: var(--mono); font-size: 11px; }

    /* Modal */
   dialog{
      width:min(960px, calc(100% - 24px));
      border:1px solid var(--line);
      border-radius: 22px;
      background: #ffffff;
      color: var(--text);
      box-shadow: 0 30px 80px rgba(11,27,58,.28);
      padding:0;
}

    dialog::backdrop{
  background: rgba(11,27,58,.28);
  backdrop-filter: blur(3px);
}
    .modalHead{
      display:flex; align-items:flex-start; justify-content:space-between; gap:12px;
      padding:16px 16px 12px;
      border-bottom:1px solid var(--line);
    }
    .modalHead h3{ margin:0; font-size:15px; line-height:1.25; }
    .modalHead .close{ border-radius:999px; padding:8px 10px; }
    .modalBody{ padding:16px; display:grid; grid-template-columns: 1.1fr .9fr; gap:14px; }
    @media (max-width: 860px){ .modalBody{ grid-template-columns: 1fr; } }
   .panel{
  border:1px solid var(--line);
  border-radius:var(--radius);
  background: #f7faff;
  padding:14px;
}

    .panel h4{
  margin:0 0 8px;
  font-size:12px;
  letter-spacing:.3px;
  text-transform:uppercase;
  color: rgba(60,86,122,.95);
}
    .panel p{ margin:0; color:var(--text); font-size:13px; line-height:1.5; }
    .panel ul{ margin:10px 0 0 18px; padding:0; color: var(--text); font-size:13px; line-height:1.55; }
    .panel ol{ margin:10px 0 0 18px; padding:0; color: var(--text); font-size:13px; line-height:1.55; }
    .panel li{ margin: 6px 0; }
    .modalFoot{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between;
      padding:14px 16px;
      border-top:1px solid var(--line);
    }
    .muted{ color:var(--muted); font-size:12px; line-height:1.4; }
    .copyRow{ display:flex; gap:10px; flex-wrap:wrap; }
    .toast{
      position:fixed; bottom:18px; left:50%; transform:translateX(-50%);
      background: rgba(0,0,0,.75); border:1px solid rgba(255,255,255,.15);
      padding:10px 12px; border-radius: 999px; color: var(--text); font-size:12px;
      opacity:0; pointer-events:none; transition: opacity .18s ease, transform .18s ease;
    }
    .toast.show{ opacity:1; transform: translateX(-50%) translateY(-2px); }
    .smallcode{ font-family:var(--mono); font-size:11px; color: rgba(232,236,255,.9); }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="title">
        <h1>Diagn√≥stico de Ocorr√™ncias Recorrentes ‚Äî DIEF/SEFAZ-RR</h1>
        <p>
          Uso interno. P√°gina para visualizar problemas recorrentes ligados ao sistema e consultar procedimentos padronizados (passo a passo).
          Atualize conforme novos padr√µes, corre√ß√µes e orienta√ß√µes da TI/gest√£o.
        </p>
      </div>
      <div class="pill">
        <span>Modo:</span> <b>Landing page est√°tica</b> <span>‚Ä¢</span>
        <span class="smallcode">index.html</span>
      </div>
    </header>

    <section class="grid kpis" id="kpis"></section>

    <section class="bar">
      <div class="barTop">
        <div class="search" title="Pesquisar por t√≠tulo, sintomas, categoria, tags...">
          üîé <input id="q" type="text" placeholder="Buscar (ex.: DARE, DSOT, Simples, agrupamento, baixa, SEI...)" />
        </div>
        <div class="chips" id="chips"></div>
      </div>
      <div class="subnote">
        Dica: clique em um card para abrir o detalhe com <b>Como identificar</b>, <b>Procedimento</b> e bot√µes para copiar o texto.
      </div>
    </section>

    <section class="list">
      <div class="sectionTitle">
        <h2>Lista de problemas</h2>
        <div class="count" id="count"></div>
      </div>
      <div class="cards" id="cards"></div>
    </section>
  </div>

  <dialog id="modal">
    <div class="modalHead">
      <div>
        <h3 id="m_title">Detalhe</h3>
        <div class="meta" id="m_badges" style="margin-top:10px;"></div>
      </div>
      <button class="btn close" id="m_close">‚úï</button>
    </div>

    <div class="modalBody">
      <div class="panel">
        <h4>Descri√ß√£o</h4>
        <p id="m_desc"></p>

        <div style="height:12px"></div>

        <h4>Impacto / Risco</h4>
        <ul id="m_impact"></ul>

        <div style="height:12px"></div>

        <h4>Como identificar</h4>
        <ul id="m_identify"></ul>
      </div>

      <div class="panel">
        <h4>Procedimento</h4>
        <ol id="m_steps"></ol>

        <div style="height:12px"></div>

        <h4>Evid√™ncias recomendadas</h4>
        <ul id="m_evidence"></ul>

        <div style="height:12px"></div>

        <h4>Resultado esperado</h4>
        <p id="m_expected"></p>
      </div>
    </div>

    <div class="modalFoot">
      <div class="copyRow">
        <button class="btn primary" id="copy_proc">Copiar procedimento</button>
        <button class="btn" id="copy_summary">Copiar resumo p/ e-mail interno</button>
      </div>
      <div class="muted">
        Sempre registrar evid√™ncias e encaminhamentos no processo/controle interno quando aplic√°vel.
      </div>
    </div>
  </dialog>

  <div class="toast" id="toast">Copiado ‚úÖ</div>

  <script>
    // ======= DADOS (edite aqui para adicionar/ajustar problemas) =======
    const PROBLEMS = [
      {
        id: "dare-avulso-sem-baixa",
        title: "DARE Avulso pago, mas d√©bito n√£o baixou automaticamente",
        category: "Arrecada√ß√£o/DARE",
        recurrence: "Alta",
        status: "Aberto",
        howShort: "Comprovante de pagamento existe, mas DSOT/sistema n√£o reflete baixa.",
        desc: "Ocorr√™ncia em que o contribuinte paga por DARE Avulso e o sistema n√£o reconhece/baixa automaticamente os d√©bitos, exigindo confer√™ncia manual e encaminhamento interno.",
        impact: [
          "Retrabalho para confer√™ncia e anexa√ß√£o de comprovantes.",
          "Risco de resposta incorreta ao contribuinte.",
          "Inconsist√™ncia entre pagamento efetivo e situa√ß√£o no DSOT/sistema."
        ],
        identify: [
          "Existe comprovante banc√°rio do pagamento do DARE.",
          "No sistema/DSOT, o d√©bito permanece em aberto ou n√£o aparece como quitado.",
          "Valores batem (ou quase batem), mas status n√£o muda."
        ],
        steps: [
          "Consultar DSOT e registrar quais d√©bitos constam em aberto (valores e refer√™ncias).",
          "Localizar no sistema da SEFAZ o registro do DARE e confirmar status de pagamento/compensa√ß√£o.",
          "Conferir se o pagamento caiu na conta do Tesouro (quando houver evid√™ncia sist√™mica).",
          "Comparar valores: total pago x soma dos d√©bitos indicados.",
          "Anexar evid√™ncias: DSOT, comprovante banc√°rio, comprovante do sistema/DARE.",
          "Registrar resumo do achado e encaminhar para provid√™ncias internas (baixa manual/ajuste).",
          "Ap√≥s regulariza√ß√£o, reconsultar DSOT e verificar se a baixa refletiu."
        ],
        evidence: ["DSOT atualizado", "Comprovante banc√°rio", "Comprovante do DARE no sistema", "Print/registro da tela com status"],
        expected: "D√©bitos baixados corretamente no sistema/DSOT e registro interno do procedimento realizado.",
        tags: ["baixa", "pagamento", "dare avulso", "dsot"]
      },
      {
        id: "dare-agrupamento-sem-espelho",
        title: "DARE Agrupamento sem espelho de itens (sem rastreabilidade)",
        category: "Arrecada√ß√£o/DARE",
        recurrence: "Alta",
        status: "Em TI",
        howShort: "DARE de agrupamento pago, mas n√£o √© poss√≠vel listar quais d√©bitos comp√µem o agrupamento.",
        desc: "O DARE de agrupamento n√£o apresenta (ou o sistema n√£o persiste/exibe) a composi√ß√£o dos d√©bitos/notas, dificultando a confer√™ncia e a baixa item a item.",
        impact: [
          "Falha de rastreabilidade do pagamento (DARE ‚Üí itens).",
          "Risco de baixa incorreta ou n√£o baixa.",
          "Aumento de demanda para confer√™ncia manual."
        ],
        identify: [
          "Pagamento do DARE agrupamento confirmado.",
          "Sistema/relat√≥rios n√£o exibem os itens/debitos vinculados ao agrupamento.",
          "DSOT n√£o reflete baixa coerente com o valor total pago."
        ],
        steps: [
          "Confirmar pagamento do DARE agrupamento (sistema e comprovante banc√°rio).",
          "Levantar, no DSOT, quais d√©bitos poderiam compor o total pago (soma aproximada).",
          "Registrar evid√™ncias de que n√£o h√° espelho/composi√ß√£o dispon√≠vel no sistema.",
          "Montar planilha/registro interno: d√©bitos suspeitos + valores + soma vs DARE.",
          "Encaminhar para TI a demanda de implementa√ß√£o do 'espelho do agrupamento' e baixa item a item.",
          "Enquanto n√£o implementado: proceder com confer√™ncia manual e anexa√ß√£o das evid√™ncias.",
          "Ap√≥s provid√™ncia, revalidar baixa no DSOT."
        ],
        evidence: ["DARE agrupamento", "Comprovante banc√°rio", "DSOT", "Registro interno de composi√ß√£o estimada", "Print evidenciando aus√™ncia do espelho"],
        expected: "Implementa√ß√£o/consulta do espelho do agrupamento e baixa item a item; no curto prazo, confer√™ncia documentada e encaminhamento √† TI.",
        tags: ["agrupamento", "rastreabilidade", "itens", "ti"]
      },
      {
        id: "debitos-nao-constam-agrupados",
        title: "D√©bitos n√£o constam como agrupados, apesar de valor total bater",
        category: "DSOT/D√©bitos",
        recurrence: "M√©dia",
        status: "Aberto",
        howShort: "Soma dos comprovantes bate, mas sistema n√£o marca todos os d√©bitos como agrupados/quitados.",
        desc: "Situa√ß√£o em que somente parte dos d√©bitos aparece como agrupada/quitada no sistema, embora haja evid√™ncias de pagamento que cobrem a totalidade.",
        impact: [
          "Contribuinte fica irregular indevidamente.",
          "Necessidade de an√°lise detalhada e corre√ß√£o manual/ajuste sist√™mico."
        ],
        identify: [
          "Um ou poucos d√©bitos constam como agrupados/quitados, outros n√£o.",
          "Comprovantes indicam quita√ß√£o do total.",
          "Diverg√™ncia entre relat√≥rios e registros de agrupamento."
        ],
        steps: [
          "Listar todos os d√©bitos no DSOT e identificar quais constam como pagos x em aberto.",
          "Conferir comprovantes de pagamento (um a um) e vincular valores aos d√©bitos.",
          "Verificar se houve emiss√£o de DAREs separados para alguns itens (ex.: √∫ltimo d√©bito).",
          "Registrar narrativa objetiva: o que consta como agrupado vs o que foi pago.",
          "Anexar evid√™ncias e encaminhar para ajuste de baixa/corre√ß√£o de v√≠nculo no sistema.",
          "Revalidar DSOT ap√≥s provid√™ncias."
        ],
        evidence: ["DSOT", "DARE(s) envolvidos", "Comprovantes banc√°rios", "Relat√≥rios/prints do sistema"],
        expected: "Todos os d√©bitos pagos devem constar como quitados e/ou corretamente vinculados ao agrupamento no sistema.",
        tags: ["diverg√™ncia", "agrupamento", "baixa", "dsot"]
      },
      {
        id: "ultimo-debito-desagrupado",
        title: "√öltimo d√©bito desagrupado e pago em guia separada (gera diverg√™ncia)",
        category: "Arrecada√ß√£o/DARE",
        recurrence: "M√©dia",
        status: "Aberto",
        howShort: "Relat√≥rio total diverge ap√≥s desagrupamento e pagamento separado de item.",
        desc: "O contribuinte desagrupa um dos itens e paga em DARE separado; o sistema pode manter o agrupamento parcial sem refletir corretamente nos relat√≥rios/DSOT.",
        impact: ["Dificuldade de conciliar total do agrupamento com DSOT.", "Poss√≠vel n√£o reconhecimento de pagamento de parte dos itens."],
        identify: ["H√° evid√™ncia de desagrupamento.", "Existe DARE separado para um dos d√©bitos.", "Total original do agrupamento n√£o bate com relat√≥rio atual."],
        steps: [
          "Confirmar quais DAREs foram pagos e em quais datas (agrupamento e avulsos).",
          "Recompor a concilia√ß√£o: total pago = DARE agrupamento (parcial) + DARE separado (desagrupado).",
          "Comparar com lista de d√©bitos do DSOT e marcar quais itens correspondem a cada DARE.",
          "Documentar diverg√™ncia do relat√≥rio e anexar evid√™ncias.",
          "Encaminhar para corre√ß√£o de baixa/v√≠nculo no sistema."
        ],
        evidence: ["DARE agrupamento", "DARE separado", "Comprovantes banc√°rios", "DSOT", "Relat√≥rio divergente"],
        expected: "Baixa correta de todos os itens e consist√™ncia entre relat√≥rios, agrupamento e DSOT.",
        tags: ["desagrupamento", "concilia√ß√£o", "dare"]
      },
      {
        id: "cadastro-regime-normal-desatualizado",
        title: "Cadastro desatualizado: contribuinte √© Simples, mas consta Regime Normal",
        category: "Cadastro/Regime",
        recurrence: "Alta",
        status: "Contornado",
        howShort: "Cadastro estadual n√£o refletiu enquadramento no Simples; gera obriga√ß√µes/multas indevidas.",
        desc: "Como o cadastro estadual pode n√£o integrar automaticamente com a base nacional, √© comum o regime ficar desatualizado, gerando obriga√ß√µes acess√≥rias indevidas.",
        impact: ["Gera√ß√£o de multas indevidas (ex.: GIM) e atendimentos recorrentes.", "Inconsist√™ncia cadastral e risco operacional."],
        identify: ["Contribuinte comprova opt√¢ncia no Simples.", "No DSOT/sistema, regime consta como Normal.", "Multas por obriga√ß√µes que Simples n√£o entrega."],
        steps: [
          "Confirmar opt√¢ncia do Simples (documento/consulta dispon√≠vel).",
          "Atualizar regime no sistema conforme procedimento interno (ex.: 'Atualizar individual').",
          "Se houver multas indevidas vinculadas a GIM, proceder com baixa/exclus√£o conforme regra interna.",
          "Registrar evid√™ncia do enquadramento e do ajuste cadastral.",
          "Orientar o registro interno e reconsultar DSOT para validar."
        ],
        evidence: ["Comprova√ß√£o do Simples (consulta/termo)", "DSOT antes/depois", "Print do ajuste cadastral"],
        expected: "Regime atualizado no cadastro estadual, com efeitos conforme enquadramento, e regulariza√ß√£o de pend√™ncias indevidas.",
        tags: ["simples", "cadastro", "regime"]
      },
      {
        id: "multas-gim-indevidas-simples",
        title: "Multas de GIM indevidas para optante do Simples",
        category: "Obriga√ß√µes Acess√≥rias",
        recurrence: "Alta",
        status: "Contornado",
        howShort: "Optante do Simples n√£o entrega GIM; multas por atraso s√£o indevidas.",
        desc: "Quando o regime est√° incorreto (ou a obriga√ß√£o foi aplicada indevidamente), surgem multas por atraso de GIM para contribuintes do Simples.",
        impact: ["Cobran√ßa indevida e alto volume de e-mails.", "Risco de desgaste institucional."],
        identify: ["Contribuinte √© Simples.", "Existem multas relacionadas √† GIM no DSOT.", "Cadastro/regime n√£o estava atualizado ou obriga√ß√£o aplicada indevidamente."],
        steps: [
          "Confirmar opt√¢ncia no Simples e vig√™ncia do enquadramento.",
          "Atualizar regime no sistema, se necess√°rio (procedimento interno).",
          "Proceder com a retirada/baixa das multas de GIM indevidas conforme rotina do setor.",
          "Registrar evid√™ncias (antes/depois).",
          "Reconsultar DSOT para garantir regulariza√ß√£o."
        ],
        evidence: ["Comprova√ß√£o Simples", "DSOT", "Print da baixa das multas", "Registro interno"],
        expected: "Multas de GIM indevidas removidas e DSOT regularizado.",
        tags: ["gim", "multa", "simples"]
      },
      {
        id: "sei-notificacoes-caixa",
        title: "Notifica√ß√µes autom√°ticas do SEI poluem a caixa de entrada",
        category: "SEI/Notifica√ß√µes",
        recurrence: "M√©dia",
        status: "Contornado",
        howShort: "E-mails autom√°ticos do SEI caem na caixa principal; precisa filtro/label.",
        desc: "Mensagens autom√°ticas do SEI competem com atendimentos reais, prejudicando triagem e produtividade.",
        impact: ["Perda de foco na caixa de entrada.", "Risco de atrasar respostas importantes."],
        identify: ["Volume alto de e-mails autom√°ticos.", "Mesmos remetentes/assuntos repetidos."],
        steps: [
          "Identificar remetente(s) e padr√µes de assunto do SEI.",
          "Criar filtro no Gmail/Grupo para aplicar marcador espec√≠fico (ex.: 'SEI-AUTOMATICO').",
          "Configurar para pular a Caixa de Entrada (arquivar) ou mover para categoria/label.",
          "Testar com 2-3 mensagens recentes e validar que o filtro est√° funcionando.",
          "Documentar o filtro no guia interno."
        ],
        evidence: ["Exemplos de e-mails do SEI", "Print do filtro", "Label criada"],
        expected: "Notifica√ß√µes autom√°ticas organizadas fora da caixa principal sem afetar atendimentos.",
        tags: ["sei", "gmail", "filtro"]
      },
      {
        id: "redesim-nao-integra",
        title: "Integra√ß√£o inexistente: RedeSim x cadastro estadual (atualiza√ß√µes n√£o refletem)",
        category: "Cadastro/Regime",
        recurrence: "M√©dia",
        status: "Em TI",
        howShort: "Altera√ß√µes na base nacional n√£o atualizam automaticamente o cadastro estadual.",
        desc: "Mudan√ßas de condi√ß√£o (ex.: Simples) e eventos cadastrais n√£o sincronizam automaticamente, exigindo corre√ß√µes manuais.",
        impact: ["Inconsist√™ncia cadastral cont√≠nua.", "Demanda recorrente por atualiza√ß√µes manuais."],
        identify: ["Contribuinte alega altera√ß√£o na RedeSim/RFB.", "Cadastro estadual n√£o mudou.", "Obriga√ß√µes e pend√™ncias surgem por regime errado."],
        steps: [
          "Confirmar a altera√ß√£o na base nacional (quando houver comprova√ß√£o).",
          "Atualizar manualmente o cadastro estadual conforme procedimento.",
          "Registrar evid√™ncias e data do ajuste.",
          "Encaminhar demanda estruturada √† TI para integra√ß√£o/rotina de sincroniza√ß√£o.",
          "Monitorar reincid√™ncia e registrar casos para dimensionar impacto."
        ],
        evidence: ["Comprova√ß√£o da altera√ß√£o", "DSOT/print cadastro", "Registro interno de casos"],
        expected: "At√© integra√ß√£o existir: atualiza√ß√£o manual padronizada; no futuro: sincroniza√ß√£o autom√°tica e queda de recorr√™ncia.",
        tags: ["redesim", "cadastro", "integra√ß√£o", "ti"]
      }
    ];

    const CATEGORIES = ["Todas", ...new Set(PROBLEMS.map(p => p.category))];

    // ======= Helpers =======
    const el = (tag, attrs={}, children=[]) => {
      const e = document.createElement(tag);
      for (const [k,v] of Object.entries(attrs)){
        if (k === "class") e.className = v;
        else if (k.startsWith("on") && typeof v === "function") e.addEventListener(k.slice(2), v);
        else e.setAttribute(k, v);
      }
      (Array.isArray(children) ? children : [children]).forEach(c => {
        if (c === null || c === undefined) return;
        e.appendChild(typeof c === "string" ? document.createTextNode(c) : c);
      });
      return e;
    };

    const badgeClass = (type, value) => {
      if (type === "recurrence"){
        if (value === "Alta") return "bad";
        if (value === "M√©dia") return "warn";
        return "info";
      }
      if (type === "status"){
        if (value === "Resolvido") return "ok";
        if (value === "Contornado") return "info";
        if (value === "Em TI") return "warn";
        return "bad"; // Aberto
      }
      return "info";
    };

    const toast = (msg="Copiado ‚úÖ") => {
      const t = document.getElementById("toast");
      t.textContent = msg;
      t.classList.add("show");
      setTimeout(() => t.classList.remove("show"), 1200);
    };

    const copyText = async (text) => {
      try{
        await navigator.clipboard.writeText(text);
        toast();
      }catch(e){
        // fallback
        const ta = el("textarea", {style:"position:fixed;left:-9999px;top:-9999px;"}, text);
        document.body.appendChild(ta);
        ta.select();
        document.execCommand("copy");
        ta.remove();
        toast();
      }
    };

    // ======= Render =======
    const state = {
      q: "",
      category: "Todas"
    };

    function computeKpis(items){
      const total = items.length;
      const alta = items.filter(p => p.recurrence==="Alta").length;
      const media = items.filter(p => p.recurrence==="M√©dia").length;
      const baixa = items.filter(p => p.recurrence==="Baixa").length;
      const emti = items.filter(p => p.status==="Em TI").length;
      return [
        {label:"Problemas cadastrados", value: total, hint:"Total de itens no painel"},
        {label:"Alta recorr√™ncia", value: alta, hint:"Priorize corre√ß√µes estruturais"},
        {label:"M√©dia recorr√™ncia", value: media, hint:"Padronize procedimentos"},
        {label:"Baixa recorr√™ncia", value: baixa, hint:"Monitore casos pontuais"},
        {label:"Em acompanhamento (TI)", value: emti, hint:"Demandas pendentes de solu√ß√£o"}
      ];
    }

    function filterProblems(){
      const q = state.q.trim().toLowerCase();
      return PROBLEMS.filter(p => {
        const byCat = state.category === "Todas" ? true : p.category === state.category;
        if (!byCat) return false;
        if (!q) return true;
        const hay = [
          p.title, p.category, p.recurrence, p.status,
          p.howShort, p.desc,
          ...(p.tags||[]),
          ...(p.identify||[]),
          ...(p.steps||[])
        ].join(" ").toLowerCase();
        return hay.includes(q);
      });
    }

    function renderChips(){
      const host = document.getElementById("chips");
      host.innerHTML = "";
      CATEGORIES.forEach(cat => {
        const chip = el("div", {
          class: "chip" + (state.category === cat ? " active" : ""),
          onclick: () => { state.category = cat; rerender(); }
        }, cat);
        host.appendChild(chip);
      });
    }

    function renderKpis(items){
      const host = document.getElementById("kpis");
      host.innerHTML = "";
      computeKpis(PROBLEMS).forEach(k => {
        host.appendChild(el("div", {class:"kpi"}, [
          el("div", {class:"label"}, k.label),
          el("div", {class:"value"}, String(k.value)),
          el("div", {class:"hint"}, k.hint)
        ]));
      });
    }

    function renderCards(items){
      const host = document.getElementById("cards");
      const count = document.getElementById("count");
      host.innerHTML = "";
      count.textContent = `${items.length} item(ns) exibido(s)`;

      if (items.length === 0){
        host.appendChild(el("div", {class:"panel"}, [
          el("h4", {}, "Nenhum resultado"),
          el("p", {class:"muted"}, "Tente ajustar a busca ou o filtro de categoria.")
        ]));
        return;
      }

      items.forEach(p => {
        const badges = el("div", {class:"meta"}, [
          el("span", {class:`badge info`}, [`Categoria: `, el("b", {}, p.category)]),
          el("span", {class:`badge ${badgeClass("recurrence", p.recurrence)}`}, [`Recorr√™ncia: `, el("b", {}, p.recurrence)]),
          el("span", {class:`badge ${badgeClass("status", p.status)}`}, [`Status: `, el("b", {}, p.status)])
        ]);

        const card = el("div", {class:"card", onclick: ()=>openModal(p)}, [
          el("div", {class:"top"}, [
            el("h3", {}, p.title),
            el("span", {class:`badge ${badgeClass("status", p.status)}`}, p.status)
          ]),
          badges,
          el("div", {class:"snippet"}, p.howShort),
          el("div", {class:"footerRow"}, [
            el("span", {}, `Tags: ${(p.tags||[]).slice(0,4).join(", ") || "‚Äî"}`),
            el("span", {class:"btn mono"}, "Ver procedimento ‚Üí")
          ])
        ]);
        host.appendChild(card);
      });
    }

    // ======= Modal =======
    let current = null;
    const modal = document.getElementById("modal");

    function openModal(p){
      current = p;
      document.getElementById("m_title").textContent = p.title;

      const mb = document.getElementById("m_badges");
      mb.innerHTML = "";
      mb.appendChild(el("span", {class:`badge info`}, [`Categoria: `, el("b", {}, p.category)]));
      mb.appendChild(el("span", {class:`badge ${badgeClass("recurrence", p.recurrence)}`}, [`Recorr√™ncia: `, el("b", {}, p.recurrence)]));
      mb.appendChild(el("span", {class:`badge ${badgeClass("status", p.status)}`}, [`Status: `, el("b", {}, p.status)]));

      document.getElementById("m_desc").textContent = p.desc;

      const impact = document.getElementById("m_impact");
      impact.innerHTML = "";
      (p.impact||[]).forEach(x => impact.appendChild(el("li", {}, x)));

      const identify = document.getElementById("m_identify");
      identify.innerHTML = "";
      (p.identify||[]).forEach(x => identify.appendChild(el("li", {}, x)));

      const steps = document.getElementById("m_steps");
      steps.innerHTML = "";
      (p.steps||[]).forEach(x => steps.appendChild(el("li", {}, x)));

      const ev = document.getElementById("m_evidence");
      ev.innerHTML = "";
      (p.evidence||[]).forEach(x => ev.appendChild(el("li", {}, x)));

      document.getElementById("m_expected").textContent = p.expected || "‚Äî";

      modal.showModal();
    }

    function closeModal(){
      modal.close();
      current = null;
    }

    document.getElementById("m_close").addEventListener("click", closeModal);
    modal.addEventListener("click", (e) => {
      const rect = modal.getBoundingClientRect();
      const isInDialog = (
        rect.top <= e.clientY && e.clientY <= rect.top + rect.height &&
        rect.left <= e.clientX && e.clientX <= rect.left + rect.width
      );
      if (!isInDialog) closeModal();
    });

    // Copy buttons
    document.getElementById("copy_proc").addEventListener("click", () => {
      if (!current) return;
      const text =
`PROBLEMA: ${current.title}
CATEGORIA: ${current.category}
RECORR√äNCIA: ${current.recurrence}
STATUS: ${current.status}

PROCEDIMENTO (passo a passo):
${(current.steps||[]).map((s,i)=>`${i+1}. ${s}`).join("\n")}

EVID√äNCIAS RECOMENDADAS:
${(current.evidence||[]).map(x=>`- ${x}`).join("\n")}

RESULTADO ESPERADO:
${current.expected || "‚Äî"}`;
      copyText(text);
    });

    document.getElementById("copy_summary").addEventListener("click", () => {
      if (!current) return;
      const text =
`Resumo interno ‚Äî ${current.title}

Como identificar:
${(current.identify||[]).map(x=>`- ${x}`).join("\n")}

A√ß√µes recomendadas (resumo):
${(current.steps||[]).slice(0,5).map((s,i)=>`${i+1}. ${s}`).join("\n")}

Observa√ß√£o:
Registrar evid√™ncias e encaminhamentos no processo/controle interno quando aplic√°vel.`;
      copyText(text);
    });

    // Search
    document.getElementById("q").addEventListener("input", (e) => {
      state.q = e.target.value || "";
      rerender();
    });

    function rerender(){
      renderChips();
      const items = filterProblems();
      renderKpis(items);
      renderCards(items);
    }

    // Initial render
    rerender();
  </script>
</body>
</html>
